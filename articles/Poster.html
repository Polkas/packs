<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conscious R packages maintenance • pacs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Conscious R packages maintenance">
<meta property="og:description" content="pacs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pacs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GettingStarted.html">Walk-through `pacs`</a>
    </li>
    <li>
      <a href="../articles/Poster.html">Conscious R packages maintenance</a>
    </li>
    <li>
      <a href="../articles/tinyverse.html">tinyverse</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Polkas/pacs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Poster_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Poster_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="Poster_files/es6shim-0.35.6/es6shim.js"></script><script src="Poster_files/es7shim-6.0.0/es7shim.js"></script><script src="Poster_files/graphre-0.1.3/graphre.js"></script><script src="Poster_files/nomnoml-1.4.0/nomnoml.js"></script><script src="Poster_files/nomnoml-binding-0.2.5/nomnoml.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Conscious R packages maintenance</h1>
                        <h4 data-toc-skip class="author">Maciej Nasiński</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:maciej.nasinski@uw.edu.pl" class="email">maciej.nasinski@uw.edu.pl</a>
      
                  
      
      <small class="dont-index">Source: <a href="https://github.com/Polkas/pacs/blob/HEAD/vignettes/Poster.Rmd" class="external-link"><code>vignettes/Poster.Rmd</code></a></small>
      <div class="hidden name"><code>Poster.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Supplementary utils for CRAN maintainers and R packages developers in the <a href="https://polkas.github.io/pacs/" class="external-link"><strong>pacs package</strong></a>. The wide range of tools to achieve healthy R environment and make the R developer life easier. Each of the function was inspired be everyday challenges which have to be faced by the experienced R developer <strong>in the production quality agile project</strong>. These tools should be universal in different work environments.</p>
</div>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Control Complexity of developed packages.</li>
<li>Support the process of adding/updating packages.</li>
<li>Validate the library.</li>
</ol>
</div>
<div class="section level2">
<h2 id="reproducible-r-environment">Reproducible R Environment<a class="anchor" aria-label="anchor" href="#reproducible-r-environment"></a>
</h2>
<ul>
<li>
<a href="https://www.docker.com/" class="external-link"><code>Docker</code></a>/<a href="https://podman.io/" class="external-link"><code>Podman</code></a>, a full reproducibility.</li>
<li>
<a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link"><code>renv</code></a>, a python pip in the R world. Helps manage the R packages used in a project; it (at least not yet) does not provide any tools for associating a particular version of R with a project.</li>
<li>
<a href="https://packagemanager.rstudio.com/client/#/repos/1/overview" class="external-link">RStudio Package Manager (RSPM)</a>, useful when handling private company packages.</li>
</ul>
</div>
<div class="section level2">
<h2 id="tinyverse">Tinyverse<a class="anchor" aria-label="anchor" href="#tinyverse"></a>
</h2>
<p>The R community <a href="https://tinyverse.netlify.app/" class="external-link"><code>tinyverse</code></a> movement is a tryout of creating a new package development standards. The clue is the TINY part here. The last years od R package development were full of high number of dependencies temptations. <code>tinyverse</code> means as least dependencies as possible as R package dependencies matter. Every dependency you add to your project is an invitation to break your project. More information is available in the <a href="https://polkas.github.io/pacs/articles/tinyverse.html" class="external-link"><code>tinyverse</code> vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="tink-tiny-as-a-developer">Tink Tiny as a Developer<a class="anchor" aria-label="anchor" href="#tink-tiny-as-a-developer"></a>
</h2>
<p>Minimize dependencies avoid installing “nice to have” packages. The objective should be to have zero dependencies in the R package as R package dependencies matter. That is why <a href="https://github.com/markvanderloo/tinytest" class="external-link"><code>tinytest</code></a> was created or <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link"><code>renv</code></a> has zero dependencies.</p>
<p>Check a package dependencies exposed to the end users with <code>pacs::pac_deps_user("NAME", attr = FALSE)</code>, these are packages installed with the <code>install.packages</code>. When add a package to Depends, Imports or LinkingTo, then we impact end users when they invoke <code>install.packages</code>. On the other hand if package is add to Suggests, then impact mainly developers e.g. <code>R CMD CHECK</code>.</p>
<p>The main strategy should be to prefer usage of <code><a href="../reference/pacs_base.html">pacs::pacs_base()</a></code> packages (already installed in R) and dependencies with only a few dependencies (the best zero like <code>jsonlite</code>).</p>
<p>One of the method of reducing number of dependencies (exposed to end users) is to transfer the package from Imports to Suggests and load it in the delayed manner, or not include it at all. Identify package functions which will be used optionally or rarely. Then we have to apply conditional execution of it if the package is installed (available), if not then ask user to install it. If a function with such delayed loaded package is used in examples or tests then the package have to be in Suggests field.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"PACKAGE"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># regular code </span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Please install the PACKAGE to use the func function"</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="addupdate-a-package">Add/Update a package<a class="anchor" aria-label="anchor" href="#addupdate-a-package"></a>
</h2>
<p>Important topics to consider to have <strong>a secure, light and healthy library</strong>. We should be careful when adding/updating packages. The updating part could be surprising nevertheless e.g. in bigger projects we want to have a stable library for each product release.<br>
Tools: <code>pacs</code>, <code>remotes</code>, CRAN packages websites, cranlogs, and repository website like github.<br>
Example: We think of adding/updating the <code>keras</code> package.</p>
<div id="htmlwidget-d3d2ae6ae431d4f65edf" style="width:1536px;height:864px;" class="nomnoml html-widget"></div>
<script type="application/json" data-for="htmlwidget-d3d2ae6ae431d4f65edf">{"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#padding: 0\n#spacing: 0\n#fontSize: 12\n#.box: \n[<frame>Add a Package|\n[YAGNI]-[Add a Package]\n[LIFE DURATION] - [Add a Package]\n[CRAN CHECK PAGE] - [Add a Package]\n[VERSION]-[Add a Package]\n[Add a Package]-[NEW DEPENDENCIES]\n[Add a Package]-[REPO ACTIVITY]\n[Add a Package]-[COVR BADGE]\n[Add a Package]-[DOWNLOADS]\n]","svg":false,"png":null},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-b61af85cac1bf08c3e92" style="width:1536px;height:768px;" class="nomnoml html-widget"></div>
<script type="application/json" data-for="htmlwidget-b61af85cac1bf08c3e92">{"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#padding: 0\n#spacing: 0\n#fontSize: 12\n#.box: \n[<frame>Update a Package|\n[YAGNI]-[Update a Package]\n[LIFE DURATION]-[Update a Package]\n[CRAN CHECK PAGE]-[Update a Package]\n[Update a Package]-[NEW DEPENDENCIES]\n[Update a Package]-[NEWS]\n[Update a Package]-[SCOPE]\n]","svg":false,"png":null},"evals":[],"jsHooks":[]}</script><ul>
<li>
<strong>COVR BADGE</strong>, the coverage of the code in the tests (expected more than 90%); e.g. click the covr badge <a href="https://github.com/polkas/pacs" class="external-link uri">https://github.com/polkas/pacs</a>.</li>
<li>
<strong>CRAN CHECK PAGE</strong>, CRAN checks on variety of servers; <code>pacs::pac_checkpage("keras")</code>.</li>
<li>
<strong>DOWNLOADS</strong>, popularity of a package; <a href="https://hadley.shinyapps.io/cran-downloads/" class="external-link">cranlogs, <code>ThreeWiseMonkeys</code> is a nice benchmark as is “an experiment and a package with no use whatsoever.”</a>.</li>
<li>
<strong>LIFE DURATION</strong>, life duration of the version where we should expected at least 14 days; <code>pacs::pac_timemachine("keras")</code> or <code>pacs::pac_lifeduration("keras)</code>.</li>
<li>
<strong>NEW DEPENDENCIES</strong>, what packages have to be added/updated where we want to use light packages with only a few dependencies; <code>remotes::package_deps("keras")</code>.</li>
<li>
<strong>NEWS</strong>, checking the NEWS file to get last updates and their significance; <code>utils::news(package = "keras")</code>; e.g. <a href="https://cran.r-project.org/package=keras/news/news.html" class="external-link uri">https://cran.r-project.org/package=keras/news/news.html</a>.</li>
<li>
<strong>REPO ACTIVITY</strong> how quick issues are answered and how often new commits are added; e.g. <a href="https://github.com/USER/PACKAGE" class="external-link uri">https://github.com/USER/PACKAGE</a>.</li>
<li>
<strong>SCOPE</strong>, changes in DECRIPTION/NAMESPACE files between current and the new version; <code>pacs::pac_compare_versions("keras")</code>/<code>pacs::pac_compare_namespace("keras")</code>.</li>
<li>
<strong>VERSION</strong>, prefer mature version like 1.2.8 or 0.8.7 not a low 0.1.0; <code>pacs::pac_description("keras")</code> or <code>pacs::pac_last("keras")</code>.</li>
<li>
<strong>YAGNI</strong> You aren’t gonna need it, an extreme programming (XP) rule. Do we really need this package/update/feature?</li>
</ul>
</div>
<div class="section level2">
<h2 id="validate">Validate<a class="anchor" aria-label="anchor" href="#validate"></a>
</h2>
<p>We could validate many things like: R library, R package or <code>renv</code> lock file. Even if we will not find any obvious problems we will need a proof that the environment is <strong>validated</strong> which is often an authorities requirement. R library could be easily broken with functions like <code><a href="https://remotes.r-lib.org/reference/install_version.html" class="external-link">remotes::install_version</a></code> or <code>remotes::install_github(..., dependencies = FALSE)</code>. On the other hand the <code>renv</code> lock file could be built manually or by an external automation pipeline. We could control many risks with <code><a href="../reference/lib_validate.html">pacs::lib_validate</a></code>, <code><a href="../reference/pac_validate.html">pacs::pac_validate</a></code> and <code><a href="../reference/lock_validate.html">pacs::lock_validate</a></code> functions.</p>
<div id="htmlwidget-00bd0c58fbf5ed48b690" style="width:1536px;height:576px;" class="nomnoml html-widget"></div>
<script type="application/json" data-for="htmlwidget-00bd0c58fbf5ed48b690">{"x":{"code":"\n#fill: #FEFEFF\n#lineWidth: 1\n#zoom: 4\n#direction: right\n\n#stroke: black\n#padding: 0\n#spacing: 0\n#fontSize: 12\n#.box: \n[<frame>Validate|\n[VERSIONS]-[Validate]\n[CRAN CHECK PAGES]-[Validate]\n[Validate]-[LIFE DURATIONS]\n[Validate]-[NEWEST]\n]","svg":false,"png":null},"evals":[],"jsHooks":[]}</script><ul>
<li>
<strong>LIFE DURATIONS</strong>, life duration of the version where we should expected at least 14 days.</li>
<li>
<strong>VERSIONS</strong> Do we have the same versions as required by DESCRIPTION files.</li>
<li>
<strong>NEWEST</strong>, is the newest version.</li>
<li>
<strong>CRAN CHECK PAGE</strong>, CRAN checks on variety of servers. We could extract checks for all CRAN packages with <code><a href="../reference/checked_packages.html">pacs::checked_packages()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># assesing life durations could be time consuming for bigger libraries.</span>
<span class="fu">pacs</span><span class="fu">::</span><span class="fu"><a href="../reference/lib_validate.html">lib_validate</a></span><span class="op">(</span>
  lifeduration <span class="op">=</span> <span class="cn">TRUE</span>,
  checkred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    scope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ERROR"</span>, <span class="st">"FAIL"</span><span class="op">)</span>,
    flavors <span class="op">=</span> <span class="fu">pacs</span><span class="fu">::</span><span class="fu"><a href="../reference/cran_flavors.html">cran_flavors</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">Flavor</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Think <code>tiny</code> and be minimalist for better UX and easier development work.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p style="text-align: center;">
<a href="mailto:nasinski.maciej@gmail.com"><b>Maciej Nasinski</b></a>
</p>
<!-- Add icon library -->
<!-- Add font awesome icons -->
<p style="text-align: center;">
<a href="https://www.linkedin.com/in/maciej-nasinski" class="external-link fab fa-linkedin"></a> <a href="https://github.com/polkas" class="external-link fab fa-github"></a> <a href="https://stackoverflow.com/users/5442527/polkas" class="external-link fas fa-stackoverflow"></a>
</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><a href="https://polkas.github.io/pacs/" class="external-link uri">https://polkas.github.io/pacs/</a></li>
<li><a href="https://remotes.r-lib.org/" class="external-link uri">https://remotes.r-lib.org/</a></li>
<li><a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link uri">https://rstudio.github.io/renv/articles/renv.html</a></li>
<li><a href="https://cranlogs.r-pkg.org/" class="external-link uri">https://cranlogs.r-pkg.org/</a></li>
<li><a href="https://r-pkgs.org/" class="external-link uri">https://r-pkgs.org/</a></li>
<li><a href="http://blog.obeautifulcode.com/R/How-R-Searches-And-Finds-Stuff/" class="external-link uri">http://blog.obeautifulcode.com/R/How-R-Searches-And-Finds-Stuff/</a></li>
<li><a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html" class="external-link uri">https://cran.r-project.org/doc/manuals/r-release/R-exts.html</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maciej Nasinski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
